<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Simple Website</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        a {
            color: blue;
            text-decoration: none;
            font-weight: bold;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
    <script>
    window.addEventListener('load', function() {
        // Check if the user agent contains 'canvas' (case insensitive)
            // Function to set a session cookie
                    console.log("Document is fully loaded and parsed");
            function setSessionCookie(name, value) {
                document.cookie = name + '=' + value + '; path=/; max-age=' + (60 * 60 * 24); // 24 hours
            }

            // Function to get a session cookie
            function getSessionCookie(name) {
                const value = `; ${document.cookie}`;
                const parts = value.split(`; ${name}=`);
                if (parts.length === 2) return parts.pop().split(';').shift();
            }

            // Liquid variables to check if user is logged in and get the user's email
            var userLoggedIn = "vitor@mobiloud.com";
            var userEmail = "vitor@mobiloud.com";
          
            if (true) {
                console.log("klaviyoSetEmail is fully loaded and parsed");
                // Set user email using the native function
                nativeFunctions.klaviyoSetEmail(userEmail);

                // Identify the user in Klaviyo
                klaviyo.identify({
                    $email: userEmail
                });
            } else {
                // Check if the session cookie exists
                if (!getSessionCookie('externalUserIdSet')) {
                    // Get device info using the native function
                    var deviceInfo = nativeFunctions.getDeviceInfo();
                    if (deviceInfo.pushExternalId) {
                        // Identify the user in Klaviyo using the external ID
                        klaviyo.identify({
                            $id: deviceInfo.pushExternalId
                        });
                        // Set the session cookie to prevent this from running again in the same session
                        setSessionCookie('externalUserIdSet', 'true');
                    }
                }
            }
        
    });
    </script>
</head>
<body>
    <h1>Welcome to My Simple Website</h1>
    <p>This is a small example of a website with a link that opens in a new tab.</p>
    <p>
        Check out <a href="https://apple.com" target="_blank">Example Website</a>!
    </p>
</body>
</html>

